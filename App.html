<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8" />
  <title></title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
<script>
function isEmpty(obj)
	{
    if(typeof obj == "undefined" || obj == null || obj == "")
	{
        return true;
    }
		else
	{
        return false;
    }
}
</script>
</head>
<body>
   
      <h2>语义配置表指定</h2>
      
      <b>Select Excel File</b>
      <input type="file" id="excel_file" />
      
      <div id="excel_data"></div>
    
</body>
</html>

<script>
const excel_file = document.getElementById('excel_file');

excel_file.addEventListener('change', (event) => {

    if(!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type))
    {
        document.getElementById('excel_data').innerHTML = 'only .xlsx or .xls file format are allowed';
        excel_file.value = '';

        return false;
    }

    var reader = new FileReader();

    reader.readAsArrayBuffer(event.target.files[0]);  //读取首选文件

    reader.onload = function(event){

        var data = new Uint8Array(reader.result);
        var work_book = XLSX.read(data, {type:'array'});  //以二进制流方式读取得到整份excel表格对象
        var sheet_name = work_book.SheetNames;            //所有子表

		var work_sheet = work_book.Sheets[sheet_name[0]];
		var sheet_data = XLSX.utils.sheet_to_json(work_sheet);
		
		var contentByRow = XLSX.utils.sheet_to_row_object_array(work_book.Sheets[sheet_name[0]]);
		 
//		console.log(contentByRow.length);     //最大列数 - 1
//		console.log(Object.keys(sheet_data[0]).length);
		console.log(work_sheet);
		

        if(sheet_data.length > 0)   //渲染表格
        {		
            var table_output = '<table>';
			
			//first colume
            for(var col = 0; col < Object.keys(sheet_data[0]).length;  col++)  //col:列
            {				
                table_output += '<tr>';   	
				table_output += '<td width=200>' + Object.keys(sheet_data[0])[col] + '</td>';  //第一行 第col列
				
								
				table_output += '<td width=300><select>';   //select td start

				var keyTmp = Object.keys(sheet_data[0])[col];
				

                for(var row = 0; row < contentByRow.length; row++)
                {
					var valTmp = sheet_data[row][keyTmp];
					
                    if(isEmpty(valTmp))
                    {					
						break;
                    }
                    else
                    {
						table_output += '<option value=' + valTmp + '>' + valTmp + '</option>'
                    }

                }
				
				table_output += '</select></td>';//select td end
				
				
                table_output += '</tr>';				
            }
			
			
			
			
			

            table_output += '</table>';
			
            document.getElementById('excel_data').innerHTML = table_output;
        }
		
		
        excel_file.value = '';
    }
});

</script>