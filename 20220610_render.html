<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="app">
        
    </div>
    <button onclick="save()">保存</button>
</body>
<script>
    let data_list=[{
        id:'kind',
        label:'kind',
        options:['a painting','a drawing','a sketch'],
        value:''
    },{
        id:'style',
        label:'style',
        options:['style_scifi','modern','The near future','future'],
        value:''
    },{
        id:'subject',
        label:'subject',
        options:['cathedral','campsite'],
        value:''
    },]
    
    function valueChange(e){  // 表单内容变更时，更新列表的里的数据
        let id=e.target.dataset.id   // 标签里面 data-xxx 会将xxx作为dataset的一个字段，所以dataset.xxx可以读取到这个值
        let match_list=data_list.filter(ele=> ele.id==id) // 过滤出操作的那个数据
        if(match_list.length>0){
            let target_data=match_list[0]
            target_data.value=e.target.value
        }
    }
    function render(data_list){
        let box_dom=document.getElementById("app")

        data_list.forEach(ele=>{
            // 创建一个div
            let line_dom=document.createElement('div')
            line_dom.classList="line_dom"
            box_dom.append(line_dom)

            // 创建select
            let select_dom=document.createElement('select')
            select_dom.onchange=valueChange
            select_dom.setAttribute('data-id',ele.id)
            ele.options.forEach(option=>{
                let option_dom=document.createElement('option')
                option_dom.setAttribute('value',option)
                option_dom.innerText=option
                select_dom.append(option_dom)
            })
            line_dom.append(select_dom)

            // 如果这一行还有其他的需要渲染，则在这里构建好dom元素然后进行插入
            // .....

        })
        
    }

    //读取excel的内容进行,替换data_list的内容
    // ...

    // 根据data_list渲染html
    render(data_list)

    function save(){
        console.log("最新的数据为:",data_list)
    }


</script>
</html>